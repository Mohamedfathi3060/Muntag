let coverProducts = [
    {
        img: "imgs/cover-product-1.jpeg",
        name: "iPhone 14 Series",
        marketLine: "Up to 10% off Voucher"
    },
    {
        img: "imgs/cover-product-2.jpeg",
        name: "DUMMY Product Name",
        marketLine: "DUMMY Market Line"
    },
    {
        img: "imgs/cover-product-2.jpeg",
        name: "DUMMY Product Name",
        marketLine: "DUMMY Market Line"
    },
];
let categories = [
    {
        categoryIcon:`  <svg width="56" height="56" viewBox="0 0 56 56" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <g clip-path="url(#clip0_986_899)">
                                <path d="M38.9375 6.125H17.0625C15.5523 6.125 14.3281 7.34922 14.3281 8.85938V47.1406C14.3281 48.6508 15.5523 49.875 17.0625 49.875H38.9375C40.4477 49.875 41.6719 48.6508 41.6719 47.1406V8.85938C41.6719 7.34922 40.4477 6.125 38.9375 6.125Z" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M25.6667 7H31.1354" stroke="black" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M28 44.0052V44.0305" stroke="black" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
                                <line x1="15.1667" y1="39.8334" x2="40.8333" y2="39.8334" stroke="black" stroke-width="2"/>
                            </g>
                            <defs>
                                <clipPath id="clip0_986_899">
                                    <rect width="56" height="56" fill="white"/>
                                </clipPath>
                            </defs>
                        </svg> `,
        categoryName:"Phones"
    },
    {
        categoryIcon:`  <svg width="56" height="56" viewBox="0 0 56 56" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <g clip-path="url(#clip0_986_202)">
                                <path d="M46.6667 9.33337H9.33333C8.04467 9.33337 7 10.378 7 11.6667V35C7 36.2887 8.04467 37.3334 9.33333 37.3334H46.6667C47.9553 37.3334 49 36.2887 49 35V11.6667C49 10.378 47.9553 9.33337 46.6667 9.33337Z" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M16.3333 46.6666H39.6667" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M21 37.3334V46.6667" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M35 37.3334V46.6667" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M8 32H48" stroke="black" stroke-width="2" stroke-linecap="round"/>
                            </g>
                            <defs>
                                <clipPath id="clip0_986_202">
                                    <rect width="56" height="56" fill="white"/>
                                </clipPath>
                            </defs>
                        </svg>  `, 
        categoryName:"Computers"
    },
];
let exploreProducts = [
    {
        img: "imgs/explore_product_1.png",
        name: "Breed Dry Dog Food",
        price: 2000,
        rating: 3.5,
        quantity: 88
    },
    {
        img: "imgs/explore_product_1.png",
        name: "Dummy Product Name",
        price: 20000,
        rating: 2,
        quantity: 100
    },
    {
        img: "imgs/explore_product_1.png",
        name: "Breed Dry Dog Food",
        price: 2000,
        rating: 3.5,
        quantity: 88
    },
    {
        img: "imgs/explore_product_1.png",
        name: "Dummy Product Name",
        price: 20000,
        rating: 2,
        quantity: 100
    },
    {
        img: "imgs/explore_product_1.png",
        name: "Breed Dry Dog Food",
        price: 2000,
        rating: 3.5,
        quantity: 88
    },
    {
        img: "imgs/explore_product_1.png",
        name: "Dummy Product Name",
        price: 20000,
        rating: 2,
        quantity: 100
    },
    {
        img: "imgs/explore_product_1.png",
        name: "Breed Dry Dog Food",
        price: 2000,
        rating: 3.5,
        quantity: 88
    },
    {
        img: "imgs/explore_product_1.png",
        name: "Dummy Product Name",
        price: 20000,
        rating: 2,
        quantity: 100
    },
    {
        img: "imgs/explore_product_1.png",
        name: "Breed Dry Dog Food",
        price: 2000,
        rating: 3.5,
        quantity: 88
    },
    {
        img: "imgs/explore_product_1.png",
        name: "Dummy Product Name",
        price: 20000,
        rating: 2,
        quantity: 100
    },
    {
        img: "imgs/explore_product_1.png",
        name: "Breed Dry Dog Food",
        price: 2000,
        rating: 3.5,
        quantity: 88
    },
    {
        img: "imgs/explore_product_1.png",
        name: "Dummy Product Name",
        price: 20000,
        rating: 2,
        quantity: 100
    },
    {
        img: "imgs/explore_product_1.png",
        name: "Breed Dry Dog Food",
        price: 2000,
        rating: 3.5,
        quantity: 88
    },
    {
        img: "imgs/explore_product_1.png",
        name: "Dummy Product Name",
        price: 20000,
        rating: 2,
        quantity: 100
    },
    {
        img: "imgs/explore_product_1.png",
        name: "Breed Dry Dog Food",
        price: 2000,
        rating: 3.5,
        quantity: 88
    },
    {
        img: "imgs/explore_product_1.png",
        name: "Dummy Product Name",
        price: 20000,
        rating: 2,
        quantity: 100
    },
    {
        img: "imgs/explore_product_1.png",
        name: "Breed Dry Dog Food",
        price: 2000,
        rating: 3.5,
        quantity: 88
    },
    {
        img: "imgs/explore_product_1.png",
        name: "Dummy Product Name",
        price: 20000,
        rating: 2,
        quantity: 100
    },
    {
        img: "imgs/explore_product_1.png",
        name: "Breed Dry Dog Food",
        price: 2000,
        rating: 3.5,
        quantity: 88
    },
    {
        img: "imgs/explore_product_1.png",
        name: "Dummy Product Name",
        price: 20000,
        rating: 2,
        quantity: 100
    },
    {
        img: "imgs/explore_product_1.png",
        name: "Breed Dry Dog Food",
        price: 2000,
        rating: 3.5,
        quantity: 88
    },
    {
        img: "imgs/explore_product_1.png",
        name: "Dummy Product Name",
        price: 20000,
        rating: 2,
        quantity: 100
    },
]
let filledStar = `<svg width="16" class="me-1" height="15" viewBox="0 0 16 15" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                    <path d="M14.673 7.17173C15.7437 6.36184 15.1709 4.65517 13.8284 4.65517H11.3992C10.7853 4.65517 10.243 4.25521 10.0617 3.66868L9.33754 1.32637C8.9309 0.0110567 7.0691 0.0110564 6.66246 1.32637L5.93832 3.66868C5.75699 4.25521 5.21469 4.65517 4.60078 4.65517H2.12961C0.791419 4.65517 0.215919 6.35274 1.27822 7.16654L3.39469 8.78792C3.85885 9.1435 4.05314 9.75008 3.88196 10.3092L3.11296 12.8207C2.71416 14.1232 4.22167 15.1704 5.30301 14.342L7.14861 12.9281C7.65097 12.5432 8.34903 12.5432 8.85139 12.9281L10.6807 14.3295C11.7636 15.159 13.2725 14.1079 12.8696 12.8046L12.09 10.2827C11.9159 9.71975 12.113 9.10809 12.5829 8.75263L14.673 7.17173Z" fill="#FFAD33"/>
                                                </svg> `;
let halfFilledStar = `<svg width="16" class="me-1 height="15" viewBox="0 0 16 15" xmlns="http://www.w3.org/2000/svg">
                                                    <defs>
                                                      <linearGradient id="half-fill" x1="0%" y1="0%" x2="100%" y2="0%">
                                                        <stop offset="50%" stop-color="#FFAD33"/>
                                                        <stop offset="50%" stop-color="white"/>
                                                      </linearGradient>
                                                    </defs>
                                                    <path d="M14.673 7.17173C15.7437 6.36184 15.1709 4.65517 13.8284 4.65517H11.3992C10.7853 4.65517 10.243 4.25521 10.0617 3.66868L9.33754 1.32637C8.9309 0.0110567 7.0691 0.0110564 6.66246 1.32637L5.93832 3.66868C5.75699 4.25521 5.21469 4.65517 4.60078 4.65517H2.12961C0.791419 4.65517 0.215919 6.35274 1.27822 7.16654L3.39469 8.78792C3.85885 9.1435 4.05314 9.75008 3.88196 10.3092L3.11296 12.8207C2.71416 14.1232 4.22167 15.1704 5.30301 14.342L7.14861 12.9281C7.65097 12.5432 8.34903 12.5432 8.85139 12.9281L10.6807 14.3295C11.7636 15.159 13.2725 14.1079 12.8696 12.8046L12.09 10.2827C11.9159 9.71975 12.113 9.10809 12.5829 8.75263L14.673 7.17173Z" 
                                                          fill="url(#half-fill)" 
                                                          stroke="#FFAD33" 
                                                          stroke-width="1" />
                                                </svg> `;
let emptyStar = `<svg width="16" class="me-1 height="15" viewBox="0 0 16 15" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                    <path opacity="0.25" d="M14.673 7.17173C15.7437 6.36184 15.1709 4.65517 13.8284 4.65517H11.3992C10.7853 4.65517 10.243 4.25521 10.0617 3.66868L9.33754 1.32637C8.9309 0.0110567 7.0691 0.0110564 6.66246 1.32637L5.93832 3.66868C5.75699 4.25521 5.21469 4.65517 4.60078 4.65517H2.12961C0.791419 4.65517 0.215919 6.35274 1.27822 7.16654L3.39469 8.78792C3.85885 9.1435 4.05314 9.75008 3.88196 10.3092L3.11296 12.8207C2.71416 14.1232 4.22167 15.1704 5.30301 14.342L7.14861 12.9281C7.65097 12.5432 8.34903 12.5432 8.85139 12.9281L10.6807 14.3295C11.7636 15.159 13.2725 14.1079 12.8696 12.8046L12.09 10.2827C11.9159 9.71975 12.113 9.10809 12.5829 8.75263L14.673 7.17173Z" fill="black"/>
                                                </svg> `;
// Abdelrahman Scope
(
    function(){
        let coverProductsCount = coverProducts.length;
        let currentCoverProduct;
        let layoutProductImg = document.querySelector(".layout .layoutimg img");
        let layoutProductName = document.querySelector(".layout .layouttext p");
        let layoutMarketingLine = document.querySelector(".layout .layouttext h1");
        let layoutTrackersList = document.querySelector(".layout .layouttrackers ul");
        let layoutTrackersPoints;
        let categoriesCount = categories.length;
        let categoriesCardContainer = document.querySelector(".browse-by-category-section .cards");
        let categoryCards;
        let categoryCard;
        let currentCategoryCard = 0;
        let categoriesLeftArrow = document.querySelector(".browse-by-category-section .controlicons .leftarrow");
        let categoriesRightArrow = document.querySelector(".browse-by-category-section .controlicons .rightarrow");
        let exploreProductsCardsContainer = document.querySelector(".explore-products-section .cards");
        let exploreProductsCardLeftArrow = document.querySelector(".explore-products-section .controlicons .leftarrow");
        let exploreProductsCardRightArrow = document.querySelector(".explore-products-section .controlicons .rightarrow");
        let exploreProductCards;
        let exploreProductCard;
        let exploreProductsCount = exploreProducts.length;
        let currentExploreProductCard = 0;

        async function getCoverProducts(){
            try {
                let res = await fetch();
                let data = await res.json();
                coverProducts = data.coverProducts;
                coverProductsCount = coverProducts.length;
            } catch (error) {
                
            }
        }

        async function getCategories(){
            try {
                let res = await fetch();
                let data = await res.json();
                categories = data.categories;
                categoriesCount = categories.length;
            } catch (error) {
                
            }
        }

        async function getExploreProducts(){
            try {
                let res = await fetch();
                let data = await res.json();
                exploreProducts = data.products;
                exploreProductsCount = exploreProducts.length;
            } catch (error) {
                
            }
        }

        function nextCoverProduct(){
            if (coverProductsCount > 1) layoutTrackersPoints[currentCoverProduct-1].classList.remove("activetrackerpoint");
            currentCoverProduct++;
            if (currentCoverProduct == coverProductsCount + 1) {
                currentCoverProduct = 1;
            }
            layoutTrackersPoints[currentCoverProduct-1].classList.add("activetrackerpoint");
            layoutProductImg.src = coverProducts[currentCoverProduct-1].img; 
            layoutProductName.innerHTML = coverProducts[currentCoverProduct-1].name;
            layoutMarketingLine.innerHTML = coverProducts[currentCoverProduct-1].marketLine;
        }

        function coverLayoutDisplay(){
            currentCoverProduct = Math.ceil(coverProductsCount / 2);
            for (let j = 0; j < coverProductsCount; j++) {
                if (j+1 == currentCoverProduct) layoutTrackersList.innerHTML += `<li class="bg-secondary rounded-5 mx-1 activetrackerpoint"></li>`;
                else layoutTrackersList.innerHTML += `<li class="bg-secondary rounded-5 mx-1"></li>`;
            }
            layoutTrackersPoints = document.querySelectorAll(".layout .layouttrackers ul li");
                setInterval(()=> {
                    nextCoverProduct();
                },5000)
        }

        function nextCategoryCard(){
            categoryCards[currentCategoryCard].classList.remove("activecard");
            currentCategoryCard++;
            if (currentCategoryCard >= (categoriesCount)) {
                currentCategoryCard = 0;
            }
            categoryCards[currentCategoryCard].classList.add("activecard");
        }

        function prevCategoryCard(){
            categoryCards[currentCategoryCard].classList.remove("activecard");
            currentCategoryCard--;
            if (currentCategoryCard < 0) {
                currentCategoryCard = categoriesCount - 1;
            }
            categoryCards[currentCategoryCard].classList.add("activecard");
        }

        function categoriesDisplay(){
            for (let i = 1; i <= categoriesCount; i++) {
                categoriesCardContainer.innerHTML += ` <div class="col-md-2 px-3">
                                                            <div class="card d-flex flex-column align-items-center py-5">
                                                                <div class="categoryicon">
                                                                    ${categories[i-1].categoryIcon}                                                
                                                                </div>
                                                                <div class="categoryname">
                                                                    <p class="m-0 fw-bold">${categories[i-1].categoryName}</p>
                                                                </div>
                                                            </div>
                                                        </div>
                `;
            }
            categoryCards = document.querySelectorAll(".browse-by-category-section .cards .col-md-2 .card");
            categoryCard = document.querySelector(".browse-by-category-section .cards .col-md-2 .card");
            if(categoriesCount > 1) currentCategoryCard = Math.ceil(categoryCards.length / 2);
            categoryCards[currentCategoryCard].classList.add("activecard");
            setInterval(()=> {
                nextCategoryCard();
            },5000)
        }

        function nextExploreProductCard(){
            exploreProductCards[currentExploreProductCard].classList.remove("activeexploreproductcard");
            currentExploreProductCard++;
            if (currentExploreProductCard >= (exploreProductsCount)) {
                currentExploreProductCard = 0;
            }
            exploreProductCards[currentExploreProductCard].classList.add("activeexploreproductcard");
        }

        function prevExploreProductCard(){
            exploreProductCards[currentExploreProductCard].classList.remove("activeexploreproductcard");
            currentExploreProductCard--;
            if (currentExploreProductCard < 0) {
                currentExploreProductCard = exploreProductsCount - 1;
            }
            exploreProductCards[currentExploreProductCard].classList.add("activeexploreproductcard");
        }
        
        function getratingstars(rating){
            let element = ``;
            for (let i = 0; i < Math.floor(rating); i++) {
                element += filledStar;
            }
            if (rating < Math.round(rating)) {
                element += halfFilledStar;
                rating = Math.ceil(rating);
            }
            while (rating < 5) {
                element += emptyStar;
                rating++;
            }
            return element;
        }
        
        function displayExploreProductCards(){
            for (let i = 0; i < exploreProductsCount; i++) {
                exploreProductsCardsContainer.innerHTML += `<div class="col-md-3 px-3">
                                                                <div class="card border-0 position-relative">
                                                                    <div class="cardimg d-flex justify-content-center py-5 rounded-1 position-relative">
                                                                        <img src="${exploreProducts[i].img}" alt="Product Image">
                                                                        <button type="button" class="btn bg-black text-white opacity-0 w-100 position-absolute bottom-0 fs-5 rounded-top-0">Add To Cart</button>
                                                                    </div>
                                                                    <div class="cardtext my-3">
                                                                        <p class="fw-bold my-1">${exploreProducts[i].name}</p>
                                                                        <div class="productdetails d-flex">
                                                                            <span class="price fw-bold text-danger me-2">$${exploreProducts[i].price}</span>
                                                                            <span class="ratingstars d-flex align-items-center">
                                                                                ${getratingstars(exploreProducts[i].rating)}
                                                                            </span>
                                                                            <span class="quantity ms-2 text-secondary fw-bold">(${exploreProducts[i].quantity})</span>
                                                                        </div>
                                                                        <div class="icons">
                                                                            <svg width="34" height="34" class="mb-1" viewBox="0 0 34 34" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                                                <circle cx="17" cy="17" r="17" fill="white"/>
                                                                                <path d="M13 10C10.7912 10 9 11.7396 9 13.8859C9 15.6185 9.7 19.7305 16.5904 23.8873C16.7138 23.961 16.8555 24 17 24C17.1445 24 17.2862 23.961 17.4096 23.8873C24.3 19.7305 25 15.6185 25 13.8859C25 11.7396 23.2088 10 21 10C18.7912 10 17 12.3551 17 12.3551C17 12.3551 15.2088 10 13 10Z" stroke="black" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                                                            </svg>
                                                                            <svg width="34" height="34" viewBox="0 0 34 34" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                                                <circle cx="17" cy="17" r="17" fill="white"/>
                                                                                <path d="M26.257 15.962C26.731 16.582 26.731 17.419 26.257 18.038C24.764 19.987 21.182 24 17 24C12.818 24 9.23601 19.987 7.74301 18.038C7.51239 17.7411 7.38721 17.3759 7.38721 17C7.38721 16.6241 7.51239 16.2589 7.74301 15.962C9.23601 14.013 12.818 10 17 10C21.182 10 24.764 14.013 26.257 15.962V15.962Z" stroke="black" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                                                                <path d="M17 20C18.6569 20 20 18.6569 20 17C20 15.3431 18.6569 14 17 14C15.3431 14 14 15.3431 14 17C14 18.6569 15.3431 20 17 20Z" stroke="black" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                                                            </svg>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>`;
            }
            exploreProductCards = document.querySelectorAll(".explore-products-section .cards .col-md-3 .card");
            exploreProductCard = document.querySelector(".explore-products-section .cards .col-md-3 .card");
            let exploreProductCardsIcons = document.querySelectorAll(".explore-products-section .cards .col-md-3 .card .icons svg");
            for (let i = 0; i < exploreProductCardsIcons.length; i++) {
                if(i % 2 == 0) exploreProductCardsIcons[i].addEventListener("click", function(){
                    exploreProductCardsIcons[i].classList.toggle("clickedIcon");
                });
                else exploreProductCardsIcons[i].addEventListener("click",function(){
                    exploreProductCardsIcons[i].classList.toggle("clickedIcon");
                });
            }
            if(exploreProductsCount > 1) currentExploreProductCard = Math.ceil(categoryCards.length / 2);
            console.log(exploreProductCards);
            console.log(currentExploreProductCard);
            console.log(exploreProductCards[currentExploreProductCard]);
            exploreProductCards[currentExploreProductCard].classList.add("activeexploreproductcard");
            setInterval(()=> {
                nextExploreProductCard();
            },5000)
        }

        async function coverLayoutManager(){
            await getCoverProducts();
            coverLayoutDisplay();
        }

        async function categoryCardManager(){
            await getCategories();
            categoriesDisplay();
        }

        async function exploreProductCardsManager(){
            await getExploreProducts();
            displayExploreProductCards();
        }

        categoriesLeftArrow.addEventListener("click", function(){
            prevCategoryCard();
        });

        categoriesRightArrow.addEventListener("click", function(){
            nextCategoryCard();
        });

        document.addEventListener("keydown", function(e){
            if (e.code == "ArrowLeft")
                 prevCategoryCard();
        });

        document.addEventListener("keydown", function(e){
            if (e.code == "ArrowRight")
                nextCategoryCard();
        });

        exploreProductsCardLeftArrow.addEventListener("click", function(){
            prevExploreProductCard();
        });

        exploreProductsCardRightArrow.addEventListener("click", function(){
            nextExploreProductCard();
        });

        document.addEventListener("keydown", function(e){
            if (e.code == "ArrowLeft")
                 prevExploreProductCard();
        });

        document.addEventListener("keydown", function(e){
            if (e.code == "ArrowRight")
                nextExploreProductCard();
        });

        coverLayoutDisplay();
        categoriesDisplay();
        displayExploreProductCards();
    }
)();
